/**
 * Backward compatibility file for the old popover.js
 *
 * @module     qtype_multianswerrgx/feedback
 * @copyright  2023 Jun Pataleta <jun@moodle.com>
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("qtype_multianswerrgx/questionedit",["jquery"],(function($){return{init:function(){let paragraphs,textContent,indexes=[5,9];for(let i=0;i<indexes.length;i++)$("#id_error_button_group_add_gaps_"+indexes[i]).css({display:"inline",color:"red"});var skipcapswordscheck=$("#id_button_group_skip_caps_words");function createGaps(interval){$("#id_error_button_group_add_gaps_5").html(""),$("#id_error_button_group_add_gaps_9").html("");var skipcapswords=skipcapswordscheck.prop("checked");const capsWords=new Array;let enoughWords;var iframeBody=$("#id_questiontext_ifr").contents().find("body");textContent=iframeBody.text(),paragraphs=iframeBody.find("p").filter((function(){return 0===$(this).find("img, audio, video").length}));if(/\{[^}]*[^}]*\}/g.test(textContent))return void $("#id_error_button_group_add_gaps_"+interval).html(M.util.get_string("addgapserror","qtype_multianswerrgx"));let paratext,totalWords=0;for(let i=0;i<paragraphs.length;i++)paratext=$(paragraphs[i]).text(),totalWords=paratext.split(" "),enoughWords=!1,totalWords.length>interval&&(enoughWords=!0);if(enoughWords)for(let i=0;i<paragraphs.length;i++){let paraText=$(paragraphs[i]).text();paraText=paraText.replace(/\s+/g," ").trim();let words=paraText.split(" "),offset=1;for(let index=0;index<words.length;index++)if((index+offset)%interval==0){let word=words[index],punctuation="";if(/[.,!?;:]+$/.test(word)&&(punctuation=word.slice(-1),word=word.slice(0,-1)),skipcapswords&&word&&word[0]===word[0].toUpperCase()&&/[A-Za-z]/.test(word[0])&&!capsWords.includes(word)){offset-=1,capsWords.push(word);continue}words[index]=`{1:SA:=${word}}${punctuation}`}let gappedText=words.join(" ");""!==gappedText&&$(paragraphs[i]).text(gappedText),$("#id_button_group_remove_gaps_button").prop("disabled",!1)}else $("#id_error_button_group_add_gaps_"+interval).html(M.util.get_string("tooshortforgapserror","qtype_multianswerrgx"))}$("#id_button_group_add_gaps_5").on("click",(function(){createGaps(5)})),$("#id_button_group_add_gaps_9").on("click",(function(){createGaps(9)})),$("#id_button_group_remove_gaps_button").on("click",(function(){var iframeBody=$("#id_questiontext_ifr").contents().find("body");textContent=iframeBody.text(),paragraphs=iframeBody.find("p").filter((function(){return 0===$(this).find("img, audio, video").length}));let paraText,cleanedText;if(/\{[^}]*[^}]*\}/g.test(textContent))for(let i=0;i<paragraphs.length;i++)paraText=$(paragraphs[i]).text(),cleanedText=paraText.replace(/{[^=]*(=|%100%)([^#}]*)[^}]*}/g,"$2"),$(paragraphs[i]).text(cleanedText);$("#id_button_group_remove_gaps_button").prop("disabled",!0),$("#id_error_button_group_add_gaps_5").html(""),$("#id_error_button_group_add_gaps_9").html("")}))}}}));

//# sourceMappingURL=questionedit.min.js.map